# Прогнозирование оттока клиентов телекоммуникационной компании
## Описание проекта 
Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.
## Описание услуг 
Оператор предоставляет два основных типа услуг:

  1. Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
  
  2. Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).

Также доступны такие услуги:
- Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);
- Выделенная линия технической поддержки (TechSupport);
- Облачное хранилище файлов для резервного копирования данных (OnlineBackup);
- Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

## Описание данных 
Данные состоят из файлов, полученных из разных источников:

- contract_new.csv — информация о договоре;
- personal_new.csv — персональные данные клиента;
- internet_new.csv — информация об интернет-услугах;
- phone_new.csv — информация об услугах телефонии.

Во всех файлах столбец "customerID" содержит код клиента.

## Общий вывод 
По результатам анализа в качестве итоговой модели была выбрана CatBoost, которая показала значение метрики AUC-ROC = 0.92. Нам удалось получить такое значение метрики используя следующие гиперпараметры :

- depth: 5
- iterations: 1000
- learning_rate: 0.1

**Список признаков, используемых для обучения лучшей модели,описание их предобработки:**
Type, PaperlessBilling, PaymentMethod, MonthlyCharges, Gender, SeniorCitizen, Partner, Dependents, InternetService, OnlineSecurity, OnlineBackup, DeviceProtection, TechSupport, StreamingTV, StreamingMovies, MultipleLines, Duration.

**Для предобработки признаков используемых для обучения лучшей модели были выполнены следующие действия:**

- Переименование признака 'Gender'(изначальное написание 'gender')
- Заполнили пропуски в признаках: "InternetService", "OnlineSecurity", "OnlineBackup", "DeviceProtection", "TechSupport", "StreamingTV", "StreamingMovies", "MultipleLines" на "No".
- Заполнили пропуски у признака "EndDate" значением "2020-02-01"(дата выгрузки), благодаря этому смогли создать целевой признак 'LastFlow'.
- Были изменены типы данных у признаков 'TotalCharges'(из object в float64), 'BeginDate'(из object в datetime64[ns]), 'EndDate'(из object в datetime64[ns])
- Был создам признак 'Duration'. Данный признак мы смогли получить рассчитав разность между 'EndDate' и 'BeginDate', затем перевели результат в дни.
- Признаки для модели CatBoost не кодировались, т.к. для данной модели нет в этом необходимости.
